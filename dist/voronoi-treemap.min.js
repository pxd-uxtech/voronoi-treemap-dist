!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3"),require("d3-weighted-voronoi"),require("d3-voronoi-map"),require("d3-voronoi-treemap"),require("seedrandom")):"function"==typeof define&&define.amd?define(["exports","d3","d3-weighted-voronoi","d3-voronoi-map","d3-voronoi-treemap","seedrandom"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).VoronoiTreemap={},t.d3,t.d3,t.d3,t.d3,t.seedrandom)}(this,function(t,e,n,a,o,r){"use strict";function i(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:function(){return t[n]}})}}),e.default=t,Object.freeze(e)}var l=i(e),s=i(n),c=i(a),d=i(o),h=i(r);const p=Object.assign({},l,s,c,d);p.seedrandom=h.default||h;class f{constructor(t){this.d3=t||p}render(t,e=10,n=3,a){const o=this.d3.select(t).select("g.cell");if(o.empty())return;const r=this.d3.select(o.node().parentNode);r.select(".cell-outline").remove(),r.select(".cell-outline2").remove();const i=r.insert("g","g.cell + *").attr("class","cell-outline"),l=r.insert("g","g.cell + *").attr("class","cell-outline").attr("id","outline2");this._renderDepth2Outlines(o,l,a),this._renderDepth1Outlines(o,i,e,n)}_renderDepth2Outlines(t,e,n){const a=this;t.selectAll(".regionArea2").each(function(t){const o=a.d3.select(this),r=t.polygon,i=n?n(t.parent.color,0,-.2,-.15):a._defaultColorVar(t.parent.color,0,-.2,-.15);if(o.style("stroke",i),r&&r.length>0){const t="M"+r.map(t=>`${t[0]},${t[1]}`).join("L")+"Z",n=a.smoothPath(t,8,2);e.append("path").attr("d",`${t} ${n}`).attr("fill",i).attr("stroke",i).attr("stroke-width",0).style("fill-rule","evenodd")}})}_renderDepth1Outlines(t,e,n,a){const o=this;t.selectAll(".regionArea1").each(function(t){const r=t.polygon;if(r&&r.length>0){const t="M"+r.map(t=>`${t[0]},${t[1]}`).join("L")+"Z",i=o.smoothPath(t,n);e.append("path").attr("d",`${t} ${i}`).attr("fill","#555").attr("stroke","#555").attr("stroke-width",a).style("fill-rule","evenodd")}})}smoothPath(t,e=10,n=0){const a=t.replace(/[MZ]/gi,"").split("L").map(t=>t.trim().split(",").map(Number)).filter(([t,e])=>!isNaN(t)&&!isNaN(e));if(a.length<3)return t;let o=this._simplifyPoints(a,n);if(o.length<3)return t;const r=o.length;let i="";for(let t=0;t<r;t++){const n=o[(t-1+r)%r],a=o[t],l=o[(t+1)%r],s={x:n[0]-a[0],y:n[1]-a[1]},c={x:l[0]-a[0],y:l[1]-a[1]},d=Math.hypot(s.x,s.y),h=Math.hypot(c.x,c.y);if(d<1e-7||h<1e-7)continue;const p={x:s.x/d,y:s.y/d},f={x:c.x/h,y:c.y/h},u=p.x*f.x+p.y*f.y;let g=Math.acos(Math.max(-1,Math.min(1,u)));const m=g<Math.PI/4.5?e/2:e,y=g/2,b=Math.min(d,h)/2.1,x=Math.min(d,h,m/Math.tan(y),b/Math.tan(y)),v=[a[0]+p.x*x,a[1]+p.y*x],w=[a[0]+f.x*x,a[1]+f.y*x];i+=0===t?`M${v[0]},${v[1]}`:` L${v[0]},${v[1]}`,i+=` Q${a[0]},${a[1]} ${w[0]},${w[1]}`}return i+="Z",i}_simplifyPoints(t,e){if(e<=0||t.length<=3)return t;const n=[t[0]];let a=t[0];for(let o=1;o<t.length;o++){const r=t[o];Math.hypot(r[0]-a[0],r[1]-a[1])>=e&&(n.push(r),a=r)}const o=n[0],r=n[n.length-1];if(r!==o){Math.hypot(o[0]-r[0],o[1]-r[1])<e&&n.pop()}return n.length>=3?n:t}_defaultColorVar(t,e=0,n=0,a=0){let o=this.d3.hsl(t);return o.h+=e,o.l+=n,o.s+=a,o.l>.95&&(o.l=.95),o.formatHex()}}class u{constructor(t){this.d3=t||p}adjust(t,e={}){const{verticalSpacing:n=0,delay:a=100}=e,o=this.d3;function r(t,e){const a=n/2;return!(t.x+t.width/2+-3<e.x-e.width/2||t.x-t.width/2- -3>e.x+e.width/2||t.y+t.height/2+a<e.y-e.height/2||t.y-t.height/2-a>e.y+e.height/2)}function i(t){const e=t.node();if(!e)return null;const n=e.getBBox();let{width:a,height:o}=n;const r=t.selectAll("tspan tspan").size()||1,i=function(t){if(!t)return{x:0,y:0};const e=t.match(/translate\(([^,]+),([^)]+)\)/);return e?{x:parseFloat(e[1]),y:parseFloat(e[2])}:{x:0,y:0}}(t.attr("transform"));return{originalX:i.x,originalY:i.y,x:i.x+a/2,y:i.y+o/2,width:a,height:o,tspanCount:r}}function l(t){if(!t||!t.polygon)return null;const e=t.polygon.map(t=>t[0]),n=t.polygon.map(t=>t[1]);return{minX:Math.min(...e),maxX:Math.max(...e),minY:Math.min(...n),maxY:Math.max(...n)}}function s(t,e,a){if(t.x+t.width/2<e.x-e.width/2||t.x-t.width/2>e.x+e.width/2)return{x:t.originalX,y:t.originalY};if(0===function(t,e){const a=n/2,o=t.y-t.height/2-a,r=t.y+t.height/2+a,i=e.y-e.height/2-a,l=e.y+e.height/2+a;return r<=i||o>=l?0:t.y<e.y?r-i:l-o}(t,e))return{x:t.originalX,y:t.originalY};const o=t.y<e.y;let r=t.y;if(o){const n=e.originalY-t.height+(t.tspanCount>1?t.height/(t.tspanCount-1)/4:0);n>=a.minY&&(r=n)}else{const n=e.originalY+e.height+(t.tspanCount>1?t.height/(t.tspanCount-1)/4:0);n+t.height<=a.maxY&&(r=n)}return{x:t.originalX,y:r}}setTimeout(()=>{const e=o.select(t);e.selectAll(".field").each(function(){!function(e){const n=e.datum();if(!n||!n.parent)return;const a=o.select(t).selectAll(".region").filter(t=>t?.data?.key===n.parent?.data?.key).nodes()[0];if(!a)return;const c=o.select(a),d=i(e),h=i(c),p=l(n);if(!p||!d||!h||0===d.width||0===d.height||0===h.width||0===h.height)return;const f=c.datum()?.data?.key;if(f&&String(f).match(/[^ ]/)&&r(d,h)){const t=s(d,h,p);e.attr("transform",`translate(${t.x},${t.y})`)}}(o.select(this))}),e.selectAll(".sector").each(function(){!function(e){const n=e.datum();if(!n||!n.parent)return;const a=o.select(t).selectAll(".field").filter(t=>t?.data?.key===n.parent?.data?.key).nodes()[0];if(!a)return;const c=o.select(a),d=i(e),h=i(c),p=l(n);if(!p||!d||!h||0===d.width||0===d.height||0===h.width||0===h.height)return;if(r(d,h)){const t=s(d,h,p);e.attr("transform",`translate(${t.x},${t.y})`)}}(o.select(this))})},a)}}function g(t,e="bigClusterLabel",n="clusterLabel"){const a=t.map(t=>({[e]:t[e],[n]:t[n],region:t.region,size:t.bubbleSize??1})),o=p.rollups(a,t=>p.sum(t.map(t=>t.size)),t=>t.region,t=>t[e],t=>t[n]),r=(a,o,r)=>o.map(o=>{const i={[e]:a,[n]:o[0],size:o[1]?o[1]:1},l=t.filter(t=>t.region===r&&t[e]===i[e]&&t[n]===i[n]);return{key:o[0],values:[i],data:l[0],raw:l}});return{key:"root_nest",values:o.map(([t,e])=>({key:t,values:e.map(([e,n])=>({key:e,values:r(e,n,t)}))})).filter(t=>t.key)}}const m={fontScale:function(t,e){let n=e.value/t.value*100;return n>30&&(n=30),n<.2&&(n=.2),p.scaleLog().domain([.1,20]).range([.3,1.5])(n)},fontScale1:function(t,e,n){let a=n/t.value*100;return a>30&&(a=30),a<.2&&(a=.2),p.scaleLog().domain([.1,20]).range([.3,1.5])(a)},fontScale2:function(t,e){let n=e.value/t.value*100;return n>5&&(n=5),n<.1&&(n=.1),p.scaleLog().domain([.1,8]).range([.5,.8])(n)},varFontScale:function(t,e){const n=e.data.data.clusterLabel??e.data.data.bigClusterLabel,[a,o]=this.multiline(n,!0);return e.data.data.clusterLabel?6*this.fontScale2(t.hierarchy,e)*o/2+20:30*this.fontScale(t.hierarchy,e)*o/2+8},getHSLColor:function(t,e,n,a){e=e||0,n=n||0,a=a||0;const o=p.hsl(t);return o.copy({h:o.h+e,s:o.s+n,l:o.l+a}).formatHex()},colorVar:function(t,e,n,a){e=e||0,n=n||0,a=a||0;let o=p.hsl(t);return o.h+=e,o.l+=n,o.s+=a,o.l>.95&&(o.l=.95),o.formatHex()},colorVar2:function(t){let e=p.hsl(t);return e.l=.3*e.l,e.s=.25,e.l>.95&&(e.l=.95),e.l<.1&&(e.l=.1),e.formatHex()},colorvariation:function(t,e,n,a){const o=p.extent(e);let r=p.scaleLinear().domain(o).range([.3,1]),i=p.hsl(t);return i.l>.8&&(i.l=.8),i.l+=.1*(.5-r(n)),i.l>.9&&(i.l=.9),i.formatHex()},colorHierarchy:function(t,e){if(0===e.depth)e.color="#ddd";else if(1===e.depth)e.color=t.regionColor(e.data.key);else if(2===e.depth)e.color=this.colorvariation(e.parent.color,e.parent.children.map(t=>t.value),e.value,e.depth+e.data.key);else if(3===e.depth&&(e.color=this.colorvariation(e.parent.color,e.parent.parent.children.map(t=>t.value),e.value,e.depth+e.data.key),t.params.colorFunc)){const n=t.data.filter(t=>t.clusterLabel===e.data.key&&t.bigClusterLabel===e.parent.data.key);e.color=t.params.colorFunc(n,e.data.data,e.color,{parentColor:e.parent.color,siblings:e.parent.parent.children.map(t=>t.value),value:e.value,depth:e.depth,region:e.parent.parent})}e.children&&e.children.forEach(e=>this.colorHierarchy(t,e))},multiline:function(t,e){const n=t?String(t):"",a=!/[^A-Za-z0-9\s\-.,!?:;@]/.test(n),o=n.split("\n");let r=[];o.forEach(t=>{const e=t.split(/[ ,]/);let n=[],o=0,i=0;n[0]="",e.forEach(t=>{t.length+o>(a?9:7)&&(i+=1,o=0,n[i]=""),n[i]=n[i]+t.trim()+" ",o+=t.length});const l=n.filter(t=>t.trim());r=r.concat(l)});const i={i:.4,j:.4,l:.4,t:.5,f:.5,r:.6,I:.3,1:.6,"!":.3,"|":.3,".":.3,",":.3,":":.3,";":.4,w:1.4,W:1.6,m:1.3,M:1.5,"@":1.4,a:.9,e:.9,o:.9,u:.9,n:.9,s:.8,A:1.1,E:1,O:1.2,U:1.1,N:1.1,S:1};const l=r.map(t=>{const e=t.trim();return!/[^A-Za-z0-9\s\-.,!?:;@]/.test(e)?function(t){return Array.from(t).reduce((t,e)=>t+(i[e]||1),0)}(e):e.length});let s=Math.max(...l);if(e)return[s,r.length];const c=r.map((t,e)=>`<tspan x=${-s/3}em dy=1em>${t.trim()}</tspan>`).join("");return`<tspan x=0em y=${-r.length/2}em>${c}</tspan>`},getLabelHeightOffset:function(t,e){const n=this.fontScale(t.hierarchy,e),[a,o]=this.multiline(e.data.key,!0);return 8*n*(o-2)},getLabelPos:function(t,e){if(1===e.depth)return[0,0];if(!e.parent?.polygon?.site||!e.polygon?.site)return[0,0];const n=e.parent.polygon.site,a=e.polygon.site;if(e.parent.children.length>1)return[a.x,a.y];const o=a.x-n.x,r=a.y-n.y;let i=0,l=0;const s=this.fontScale2(t.hierarchy,e),[c,d]=this.multiline(e.data.key,!0),h=6*s*d,p=6*s*c,f=Math.max(18,h/2);Math.abs(r)<f&&(i=r>=0?f:-f,Math.abs(o)<p&&(l=o>=0?p/2:-p/2));const u=this.getPolygonBounds(e.parent.polygon),g=a.x+l,m=a.y+i;return g<u.minX+p/2?l=u.minX+p/2-a.x:g>u.maxX-p/2&&(l=u.maxX-p/2-a.x),m<u.minY+h/2?i=u.minY+h/2-a.y:m>u.maxY-h/2&&(i=u.maxY-h/2-a.y),[a.x+l,a.y+i]},getPolygonBounds:function(t){const e=t.map(t=>t[0]),n=t.map(t=>t[1]);return{minX:Math.min(...e),maxX:Math.max(...e),minY:Math.min(...n),maxY:Math.max(...n)}},estimatePolygonRadius:function(t){if(!t.polygon?.site?.originalObject?.polygon)return 0;const e=t.polygon.site.originalObject.polygon.area();return Math.sqrt(e/Math.PI)},estimateLabelWidth:function(t,e,n){n=n||1;const a=this.fontScale(t.hierarchy,e)*n,[o,r]=this.multiline(e.data.key,!0);return Math.max(16*a*o*.8,60)},estimateLabelHeight:function(t,e,n){n=n||1;const a=this.fontScale(t.hierarchy,e)*n,[o,r]=this.multiline(e.data.key,!0);return Math.max(16*a*r*1.5,40)},createLabelContext:function(t,e,n){return{key:e.data.key,value:e.value,depth:e.depth,data:e.data.values[0]?.data,ratio:e.value/t.totalValue,percentText:p.format(".0%")(e.value/t.totalValue),color:e.color,parentColor:e.parent?.color,darkerColor:this.getHSLColor(e.color,0,-.1,-.2),lighterColor:this.getHSLColor(e.color,0,.1,.1),fontSize:1===n?1.15*this.fontScale(t.hierarchy,e):this.fontScale(t.hierarchy,e),centerX:e.polygon?.site?.x??0,centerY:e.polygon?.site?.y??0,polygon:e.polygon,parent:e.parent?{key:e.parent.data.key,value:e.parent.value,color:e.parent.color}:null,children:e.children?e.children.map(t=>({key:t.data.key,value:t.value,color:t.color})):null,totalValue:t.totalValue,formatNumber:t=>this.bigFormat(t),formatPercent:t=>p.format(".1%")(t)}},bigFormat:function(t){const e=t>10**12?Math.floor(t/10**12)%1e4:0,n=t>10**8?Math.round(t/10**8)%1e4:0,a=parseInt(t/1e4)%1e4;return(e>=1?p.format(",.0f")(e)+"조 ":" ")+(n>=1?p.format(",.0f")(n)+"억 ":" ")+(t<10**10&&a>=1?p.format(",.0f")(a)+"만 ":" ")+(t<1e4?p.format(",.0f")(Math.round(t)):" ")},createCustomVoronoiAlgorithm:function(t,e){e=e||!1;const n=Math.random;var a=[[0,0],[0,1],[1,1],[1,0]],o=[[0,0],[1,1]],r=[1,1],i=.01,l=50,s=.01,c=n,d={},h=p.voronoiMapSimulation([{weight:1},{weight:1}]).stop();const f=this,u=function(t){g(a,t)};u.convergenceRatio=function(t){return arguments.length?(i=t,u):i},u.maxIterationCount=function(t){return arguments.length?(l=t,u):l},u.minWeightRatio=function(t){return arguments.length?(s=t,u):s},u.clip=function(t){return arguments.length?(h.clip(t),a=h.clip(),o=h.extent(),r=h.size(),u):a},u.extent=function(t){return arguments.length?(h.extent(t),a=h.clip(),o=h.extent(),r=h.size(),u):o},u.size=function(t){return arguments.length?(h.size(t),a=h.clip(),o=h.extent(),r=h.size(),u):r},u.prng=function(t){return arguments.length?(c=t,u):c},u.initialPositions=function(t){return arguments.length?(d=t,u):d};const g=function(n,a){var o;if(a.polygon=n,0!=a.height){for(var r=(o=p.voronoiMapSimulation(a.children).clip(n).weight(t=>t.value).convergenceRatio(i).maxIterationCount(l).minWeightRatio(s).prng(c).initialPosition(f.createInitialPositioner(t,d,e)).stop()).state();!r.ended;)o.tick(),r=o.state();r.polygons.forEach(function(t){t.site?.originalObject?.data?.originalData&&g(t,t.site.originalObject.data.originalData)})}};return u},createInitialPositioner:function(t,e,n){var a,o,r,i,l,s,c,d;function h(t,e){return e.find(e=>e.depth===t.depth&&e.key===t.data.key)}return function(n,f,u,g){var m=!1;if(a!==g.clip()&&(a=g.clip(),o=g.extent(),m=!0),m&&(r=o[0][0],i=o[1][0],l=o[0][1],s=o[1][1],c=i-r,d=s-l),0===n.depth)return[(r+i)/2,(l+s)/2];const y=n.parent||u[0].parent,b=function(t,e){return t.map(t=>h(t,e)).filter(t=>void 0!==t)}(y?y.children:u,e);if(b.length>0){const o=p.extent(b,t=>t.x),r=p.extent(b,t=>t.y),i=h(n,e);if(i){const e=i.x*t.width,n=i.y*t.height;if(p.polygonContains(a,[e,n]))return[e,n];const[l,s]=function(t,e,n,a){const o=Math.atan2(e,t),r=o<0?o+2*Math.PI:o;let i,l,s,c;for(let t=0;t<n.length;t++)if(r<=n[t].angle){i=0===t?n[n.length-1].angle:n[t-1].angle,l=n[t].angle,s=0===t?n[n.length-1]:n[t-1],c=n[t];break}void 0===i&&(i=n[n.length-1].angle,l=n[0].angle+2*Math.PI,s=n[n.length-1],c=n[0]);const d=(r-i)/(l-i),h=s.x+d*(c.x-s.x),f=s.y+d*(c.y-s.y),u=Math.sqrt(t*t+e*e)/Math.sqrt(2)*.9,g=u*h,m=u*f,y=p.extent(a,t=>t[0]),b=p.extent(a,t=>t[1]);return[p.scaleLinear().domain([-1,1]).range(y)(g),p.scaleLinear().domain([-1,1]).range(b)(m),r,u,[t,e]]}(p.scaleLinear().domain(o).range([-1,1])(i.x),p.scaleLinear().domain(r).range([-1,1])(i.y),function(t){const e=p.extent(t,t=>t[0]),n=p.extent(t,t=>t[1]);return t.map(t=>{const a=p.scaleLinear().domain(e).range([-1,1])(t[0]),o=p.scaleLinear().domain(n).range([-1,1])(t[1]),r=Math.atan2(o,a);return{angle:r<0?r+2*Math.PI:r,point:t,x:a,y:o}}).sort((t,e)=>t.angle-e.angle)}(a),a);return[l,s]}}let x,v;do{x=r+c*g.prng()(),v=l+d*g.prng()()}while(!p.polygonContains(a,[x,v]));return[x,v]}}};function y(t){const e=document.querySelector(".voronoi-popup-content");if(e&&e.remove(),!t)return null;const n=t.event,a=t.data||{},o=document.createElement("div");o.className="voronoi-popup-content";const r=n.pageX,i=n.pageY;o.style.left=r+"px",o.style.top=i+"px";const l=document.createElement("div");return l.className="voronoi-popup-message",l.innerHTML=`\n    <div style="font-size: 1.2em; font-weight: bold; margin-bottom: 0.5em;">\n      ${a.bigClusterLabel||"N/A"}\n    </div>\n    <div style="margin-bottom: 0.3em;">\n      <strong>Region:</strong> ${a.region||"N/A"}\n    </div>\n    <div>\n      <strong>Size:</strong> ${a.bubbleSize||"N/A"}\n    </div>\n  `,o.appendChild(l),document.body.appendChild(o),setTimeout(()=>{const t=e=>{o.contains(e.target)||(o.remove(),document.removeEventListener("click",t))};document.addEventListener("click",t)},0),o}function b(){return"\n@font-face {\n    font-family: 'KoddiUD OnGothic';\n    src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/KoddiUDOnGothic-Regular.woff') format('woff');\n    font-weight: normal;\n    font-style: normal;\n}\n\n@font-face {\n    font-family: 'KoddiUDOnGothic-Bold';\n    src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/KoddiUDOnGothic-Bold.woff') format('woff');\n    font-weight: normal;\n    font-style: normal;\n}\n\nbody {\n    font-family: \"KoddiUD OnGothic\", sans-serif;\n}\n\n.caption {\n    color: #888;\n}\n\n.region {\n    font-family: \"KoddiUDOnGothic-Bold\", \"KoddiUD OnGothic\", sans-serif;\n    fill: #fff;\n    fill-opacity: 1;\n    font-weight: 700;\n    stroke-width: 3px;\n    pointer-events: none;\n}\n\n.area1 {\n    stroke: #464749aa;\n    stroke-width: 2;\n}\n\n.area2 {\n    stroke: #ffffffb0;\n    stroke-width: 0.5;\n}\n\n.area2.highlite {\n    filter: hue-rotate(-5deg) brightness(0.95);\n}\n\n.area2.clicked {\n    stroke: #000;\n    stroke-width: 3px;\n    filter: brightness(0.9);\n}\n\n.regionArea1 {\n    stroke: #464749aa;\n    stroke-width: 1.5;\n}\n\n.regionArea2 {\n    stroke: #46474955;\n    stroke-width: 0.7;\n}\n\n.regionArea3 {\n    stroke: #ffffffb0;\n    stroke-width: 0.5;\n    cursor: pointer;\n}\n\n.regionArea3.clicked {\n    stroke-width: 1px;\n    filter: hue-rotate(-5deg) brightness(0.9);\n}\n\n.regionArea3.highlite,\n.regionArea3:hover {\n    filter: hue-rotate(-5deg) brightness(0.95);\n}\n\n.field {\n    font-size: 1.2em;\n    font-weight: 600;\n    fill: #000d;\n    pointer-events: none;\n}\n\n.sector {\n    font-size: 0.8em;\n    font-weight: 400;\n    fill: #a95b5bdd;\n    cursor: default;\n    pointer-events: none;\n}\n\n.budget {\n    fill: #c25a50;\n    font-size: 12px;\n    cursor: default;\n    pointer-events: none;\n}\n\n.percent .budget {\n    fill: #fff;\n}\n\n.bubblepopup {\n    max-width: 350px;\n    min-width: 200px;\n    padding: 1em;\n    line-height: 1.5;\n    color: #444;\n    text-align: left;\n    max-height: 400px;\n    overflow: scroll;\n}\n\n.voronoi-popup-content {\n    position: absolute;\n    background: #fffe;\n    border: 2px solid #555;\n    border-radius: 30px;\n    padding: 10px;\n    z-index: 1000000;\n    transform: translateX(-50%) translateY(-100%);\n    min-width: 100px;\n}\n\n.voronoi-popup-content::before {\n    content: \" \";\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    margin-left: -10px;\n    border-width: 10px;\n    border-style: solid;\n    border-color: #555 transparent transparent transparent;\n}\n\n.voronoi-popup-content::after {\n    content: \" \";\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    margin-left: -8px;\n    border-width: 8px;\n    border-style: solid;\n    border-color: #fff transparent transparent transparent;\n}\n\n.voronoi-popup-message {\n    max-width: 350px;\n    min-width: 200px;\n    padding: 1em;\n    line-height: 1.5;\n    color: #444;\n    text-align: left;\n    max-height: 400px;\n    overflow-y: scroll;\n    overflow-x: clip;\n}\n"}class x{constructor(){this.margin={top:50,right:50,bottom:50,left:50},this.svg=null,this.data=null,this.hierarchy=null,this.allNodes=null,this._pebbleRenderer=null,this._labelAdjuster=null}static get DEFAULT_COLORS(){return"#afc7dd,#ffe9a9,#f69f8f,#b4c8af,#e9e4d6,#bed1d8,#f8dba1,#fcbc8b,#d7e0c4,#c5b5a6,#b5ccc1,#e9bfb4,#e9f0f6,#fffefb,#fce0db,#e1e9df,#f1f5f7,#fef8ed,#feeada,#fbfcf9,#e5ded7,#e5edea,#fbf5f3,#96b6d3,#ffdf85,#f3836e,#a0b99a,#ddd4be,#a7c1cb,#f5cf80,#fba868,#c7d4ac,#b7a490,#a0bdb0,#e1a799,#d7e3ee,#fff7e1,#facbc3,#d3dfd0,#fdfcfa,#e1eaed,#fcefd5,#fddcc2,#f0f3e9,#dbd2c8,#d6e3dd,#f6e4df,#dee8f1,#fffaeb,#fbd4cc,#d9e3d6,#e7eef1,#fcf3df,#fee1cc,#f4f7ef,#dfd7ce,#dce7e2,#f8ebe7,#e5edf4,#fffdf5,#fcdcd6,#dfe7dc,#eef3f5,#fdf6e8,#fee7d6,#f9faf6,#e3dcd4,#e2ebe7,#faf1ef,#d0b7ba,#b8cec4,#d2b6b6,#b6bdd6,#d9b8b7,#ded5b6,#bac2d7,#c8d5be,#e3bfb7,#f9dfb3,#eac2b8,#c1d3da,#ddc7c1,#d9e2c7,#cfdad5,#eecdc1,#ccdddf,#c7d7e6,#ded6cf,#e7d1cb,#ced9e5,#eedbc8,#d7e3e2,#e3ead2,#ecdcd2,#d9e0e5,#efe1d2,#ebdad7,#eed6da,#e1e6de,#dde4e8,#eee1d8,#f5e8d7,#f1e6dd,#f5e8de,#f3e7e1,#f5eee1,#f5f2ec".split(",")}static get DEFAULT_OPTIONS(){return{width:500,height:300,maptitle:"",caption:"",clickFunc:()=>{},colorFunc:null,getCellColors:null,sizeLimit:1e3,ratioLimit:0,pieSize:1,colors:x.DEFAULT_COLORS,seedRandom:10,showRegion:!1,showPercent:!1,underLabel:!1,regionPositions:null,forceNodeFunc:null,debug:!1,pebbleRound:25,pebbleWidth:3,regionColors:[],regionLabelRenderer:null,bigClusterLabelRenderer:null}}get pebbleRenderer(){return this._pebbleRenderer||(this._pebbleRenderer=new f(p)),this._pebbleRenderer}get labelAdjuster(){return this._labelAdjuster||(this._labelAdjuster=new u(p)),this._labelAdjuster}render(t,e={}){return this.params={...x.DEFAULT_OPTIONS,...e},this.data=t,this._setupSVG(),this._prepareData(),this._setupGroups(),this._drawTitleAndCaption(),this._createRegionColorScale(),this._computeLayout(),this._drawCells(),this._drawLabels(),this._buildLabelCache(),this._applyPostEffects(),this.svg.node()}update(t){return this.render(t,this.params)}_setupSVG(){this.svg=p.create("svg").attr("width",this.params.width+this.margin.left+this.margin.right).attr("height",this.params.height+this.margin.top+this.margin.bottom),this.svg.append("style").text("\n@font-face {\n    font-family: 'KoddiUD OnGothic';\n    src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/KoddiUDOnGothic-Regular.woff') format('woff');\n    font-weight: normal;\n    font-style: normal;\n}\n\n@font-face {\n    font-family: 'KoddiUDOnGothic-Bold';\n    src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/KoddiUDOnGothic-Bold.woff') format('woff');\n    font-weight: normal;\n    font-style: normal;\n}\n\nbody {\n    font-family: \"KoddiUD OnGothic\", sans-serif;\n}\n\n.caption {\n    color: #888;\n}\n\n.region {\n    font-family: \"KoddiUDOnGothic-Bold\", \"KoddiUD OnGothic\", sans-serif;\n    fill: #fff;\n    fill-opacity: 1;\n    font-weight: 700;\n    stroke-width: 3px;\n    pointer-events: none;\n}\n\n.area1 {\n    stroke: #464749aa;\n    stroke-width: 2;\n}\n\n.area2 {\n    stroke: #ffffffb0;\n    stroke-width: 0.5;\n}\n\n.area2.highlite {\n    filter: hue-rotate(-5deg) brightness(0.95);\n}\n\n.area2.clicked {\n    stroke: #000;\n    stroke-width: 3px;\n    filter: brightness(0.9);\n}\n\n.regionArea1 {\n    stroke: #464749aa;\n    stroke-width: 1.5;\n}\n\n.regionArea2 {\n    stroke: #46474955;\n    stroke-width: 0.7;\n}\n\n.regionArea3 {\n    stroke: #ffffffb0;\n    stroke-width: 0.5;\n    cursor: pointer;\n}\n\n.regionArea3.clicked {\n    stroke-width: 1px;\n    filter: hue-rotate(-5deg) brightness(0.9);\n}\n\n.regionArea3.highlite,\n.regionArea3:hover {\n    filter: hue-rotate(-5deg) brightness(0.95);\n}\n\n.field {\n    font-size: 1.2em;\n    font-weight: 600;\n    fill: #000d;\n    pointer-events: none;\n}\n\n.sector {\n    font-size: 0.8em;\n    font-weight: 400;\n    fill: #a95b5bdd;\n    cursor: default;\n    pointer-events: none;\n}\n\n.budget {\n    fill: #c25a50;\n    font-size: 12px;\n    cursor: default;\n    pointer-events: none;\n}\n\n.percent .budget {\n    fill: #fff;\n}\n\n.bubblepopup {\n    max-width: 350px;\n    min-width: 200px;\n    padding: 1em;\n    line-height: 1.5;\n    color: #444;\n    text-align: left;\n    max-height: 400px;\n    overflow: scroll;\n}\n\n.voronoi-popup-content {\n    position: absolute;\n    background: #fffe;\n    border: 2px solid #555;\n    border-radius: 30px;\n    padding: 10px;\n    z-index: 1000000;\n    transform: translateX(-50%) translateY(-100%);\n    min-width: 100px;\n}\n\n.voronoi-popup-content::before {\n    content: \" \";\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    margin-left: -10px;\n    border-width: 10px;\n    border-style: solid;\n    border-color: #555 transparent transparent transparent;\n}\n\n.voronoi-popup-content::after {\n    content: \" \";\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    margin-left: -8px;\n    border-width: 8px;\n    border-style: solid;\n    border-color: #fff transparent transparent transparent;\n}\n\n.voronoi-popup-message {\n    max-width: 350px;\n    min-width: 200px;\n    padding: 1em;\n    line-height: 1.5;\n    color: #444;\n    text-align: left;\n    max-height: 400px;\n    overflow-y: scroll;\n    overflow-x: clip;\n}\n"),this.svg.append("rect").attr("width","100%").attr("height","100%").style("fill","#fff"),this.width=this.params.width*Math.sqrt(this.params.pieSize),this.height=this.width*(this.params.height/this.params.width)}_prepareData(){const t=g(this.data,"bigClusterLabel","clusterLabel");this.hierarchy=p.hierarchy(t,t=>t.values).sum(t=>t.size),this.totalValue=this.hierarchy.value}_setupGroups(){this.chartGroup=this.svg.append("g").attr("transform",`translate(${this.margin.left},${this.margin.top})`),this.voronoiGroup=this.chartGroup.append("g").attr("class","cell"),this.labelsGroup=this.chartGroup.append("g").attr("class","labels"),this.popLabelsGroup=this.chartGroup.append("g").attr("class","pop"),this.bigLabelsGroup=this.chartGroup.append("g").attr("class","label1"),this.percentLabelsGroup=this.chartGroup.append("g").attr("class","percent"),this.regionLabelsGroup=this.chartGroup.append("g").attr("class","region")}_drawTitleAndCaption(){this.svg.append("g").append("text").attr("class","title").attr("text-anchor","middle").attr("font-size","22").attr("font-weight","600").attr("transform",`translate(${this.margin.left+this.width/2},${this.margin.top-15})`).html(this.params.maptitle),this.svg.append("g").append("text").attr("class","caption").attr("text-anchor","middle").attr("font-size","15").attr("font-weight","400").attr("fill","#888").attr("transform",`translate(${this.margin.left+this.width/2},${this.margin.top+this.height+30})`).html(this.params.caption)}_createRegionColorScale(){const t=p.rollup(this.data,t=>p.sum(t,t=>parseFloat(t.bubbleSize)||1),t=>t.region),e=Array.from(t.entries()).sort((t,e)=>e[1]-t[1]).map(t=>t[0]),{regionColors:n,colors:a}=this.params,o=new Map(n.map(t=>[t.key,t.color]));let r={};e.forEach((t,e)=>{r[t]=a[e%a.length]}),o.forEach((t,e)=>{r[e]=t}),this.regionColor=p.scaleOrdinal().domain(Object.keys(r)).range(Object.values(r))}_computeLayout(){const t=p.range(100).map(t=>{let e=Math.cos(t/50*Math.PI);const n=.92;e>n&&(e=n+.5*(e-n)),e<-n&&(e=.5*(e+n)-n),e/=.94;const a=Math.sin(t/25*Math.PI);return[this.width*(1+.99*e)/2,this.height*(1+.99*a)/2]}),e=p.seedrandom(this.params.seedRandom);if(p.voronoiTreemap().prng(e).clip(t)(this.hierarchy),this.params.regionPositions&&"auto"!==this.params.regionPositions){const n=this._normalizePositions(this.params.regionPositions);m.createCustomVoronoiAlgorithm(this,this.params.debug).size([this.width,this.height]).clip(t).prng(e).initialPositions(n)(this.hierarchy)}if(m.colorHierarchy(this,this.hierarchy),this.allNodes=this.hierarchy.descendants().sort((t,e)=>e.depth-t.depth).map((t,e)=>Object.assign({},t,{id:e})),this.params.getCellColors){const t=this._extractCellColors();this.params.getCellColors(t)}}_extractCellColors(){const t=[];return this.hierarchy.descendants().forEach(e=>{e.depth>0&&t.push({depth:e.depth,key:e.data.key,color:e.color})}),t}_normalizePositions(t){const e=[],n=this.hierarchy.descendants(),a=(t,e=.02)=>{const n=new Map;return t.forEach(t=>{const a=`${t.x.toFixed(6)},${t.y.toFixed(6)}`,o=n.get(a)||0;if(o>0){const n=2.4*o%(2*Math.PI),a=e*Math.sqrt(o);t.x=Math.max(.05,Math.min(.95,t.x+a*Math.cos(n))),t.y=Math.max(.05,Math.min(.95,t.y+a*Math.sin(n)))}n.set(a,o+1)}),t},o=t.filter(t=>1===t.depth);if(o.length>0){const t=p.extent(o,t=>t.x),n=p.extent(o,t=>t.y),r=t[0]===t[1]?()=>.5:p.scaleLinear().domain(t).range([.15,.85]),i=n[0]===n[1]?()=>.5:p.scaleLinear().domain(n).range([.15,.85]),l=o.map(t=>({...t,x:r(t.x),y:i(t.y)}));a(l),e.push(...l)}return[2,3].forEach(o=>{const r=t.filter(t=>t.depth===o);if(0===r.length)return;const i=n.filter(t=>t.depth===o);p.group(i,t=>t.parent?.data?.key).forEach((t,n)=>{const o=new Set(t.map(t=>t.data.key)),i=r.filter(t=>o.has(t.key));if(0===i.length)return;const l=p.extent(i,t=>t.x),s=p.extent(i,t=>t.y),c=l[0]===l[1]?()=>.5:p.scaleLinear().domain(l).range([.15,.85]),d=s[0]===s[1]?()=>.5:p.scaleLinear().domain(s).range([.15,.85]),h=i.map(t=>({...t,x:c(t.x),y:d(t.y)}));a(h),e.push(...h)})}),e}_drawCells(){const{clickFunc:t}=this.params,e=this;this.voronoiGroup.selectAll("path").data(this.allNodes).enter().append("path").attr("d",t=>"M"+t.polygon.join("L")+"Z").style("fill",t=>t.color??t.parent.color).attr("class",t=>`regionArea${t.depth} area-${t.id}`).style("fill-opacity",t=>3===t.depth?1:0).attr("pointer-events",t=>3===t.depth?"all":"none").on("click",function(n,a){let o=e.voronoiGroup.select(`.area-${a.id}`);const r=o.attr("class").match("clicked");e.voronoiGroup.select(".clicked").classed("clicked",!1),o.classed("clicked",!r),t(r?"":{...a.data,event:n,d:a,clickArea:o})}).on("mouseenter",function(t,n){const a=e._bigClusterLabelCache?.get(n.data.data.bigClusterLabel);a&&(a.node().style.opacity=1);const o=e._clusterLabelCache?.get(n.data.data.clusterLabel);o&&(o.node().style.opacity=1)}).on("mouseleave",function(t,n){const a=e.params.ratioLimit,o=e._bigClusterLabelCache?.get(n.data.data.bigClusterLabel);o&&(o.node().style.opacity=o._cachedRatio>=a?1:0);const r=e._clusterLabelCache?.get(n.data.data.clusterLabel);r&&(r.node().style.opacity=r._cachedRatio>=a?1:0)})}_drawLabels(){this._drawRegionLabels(),this._drawBigClusterLabels(),this._drawPercentLabels(),this._drawSectorLabels(),this._drawPopLabels()}_buildLabelCache(){this._bigClusterLabelCache=new Map,this._clusterLabelCache=new Map,this.bigLabelsGroup.selectAll("[data-bigCluster]").nodes().forEach(t=>{const e=t.getAttribute("data-bigCluster");if(e){const n=p.select(t);n._cachedRatio=parseFloat(t.getAttribute("data-ratio"))||0,this._bigClusterLabelCache.set(e,n)}}),this.labelsGroup.selectAll("[data-cluster]").nodes().forEach(t=>{const e=t.getAttribute("data-cluster");if(e){const n=p.select(t);n._cachedRatio=parseFloat(t.getAttribute("data-ratio"))||0,this._clusterLabelCache.set(e,n)}})}_drawRegionLabels(){const{showRegion:t,regionLabelRenderer:e}=this.params,n=this.allNodes.filter(t=>1===t.depth);e?this.regionLabelsGroup.selectAll("foreignObject").data(n).enter().append("foreignObject").attr("class","region-label-foreign").attr("data-region",t=>t.data.key).attr("width",t=>{const e=m.getPolygonBounds(t.polygon);return.6*(e.maxX-e.minX)}).attr("height",t=>m.estimateLabelHeight(this,t,1.3)).attr("x",t=>{if(!t.polygon?.site)return 0;const e=m.getPolygonBounds(t.polygon),n=e.maxX-e.minX;return t.polygon.site.x-.6*n/2}).attr("y",t=>t.polygon?.site?t.polygon.site.y-.4*m.estimateLabelHeight(this,t,1.3)+m.getLabelHeightOffset(this,t):0).style("opacity",t?1:0).style("pointer-events","none").style("overflow","visible").append("xhtml:div").style("width","100%").style("height","100%").style("display","flex").style("align-items","center").style("justify-content","center").html(t=>{const n=m.multiline(t.data.key),a=m.createLabelContext(this,t,1);return e(t,n,a)}):this.regionLabelsGroup.selectAll("text").data(n).enter().append("text").attr("class","region").attr("text-anchor","start").attr("ratio",t=>t.value/t.parent.value).style("font-size",t=>1.15*m.fontScale(this.hierarchy,t)+"em").style("fill-opacity",t?1:0).style("stroke-opacity",t?.85:0).style("stroke",t=>`${m.getHSLColor(t.color,0,-.05,-.2)}`).attr("paint-order","stroke").attr("transform",t=>t.polygon?.site?`translate(${[t.polygon.site.x,t.polygon.site.y+m.getLabelHeightOffset(this,t)]})`:"translate(0,0)").html(t=>m.multiline(t.data.key))}_drawBigClusterLabels(){const{ratioLimit:t,bigClusterLabelRenderer:e}=this.params,n=this.allNodes.filter(t=>2===t.depth);e?this.bigLabelsGroup.selectAll("foreignObject").data(n).enter().append("foreignObject").attr("class","bigcluster-label-foreign").attr("data-bigCluster",t=>t.data.key).attr("data-value",t=>t.value).attr("data-ratio",t=>t.value/this.totalValue).attr("width",t=>{const e=m.getPolygonBounds(t.polygon);return.6*(e.maxX-e.minX)}).attr("height",t=>m.estimateLabelHeight(this,t,1.2)).attr("x",t=>{if(!t.polygon?.site)return 0;const e=m.getPolygonBounds(t.polygon),n=e.maxX-e.minX;return t.polygon.site.x-.6*n/2}).attr("y",t=>t.polygon?.site?t.polygon.site.y-.45*m.estimateLabelHeight(this,t,1.2)+m.getLabelHeightOffset(this,t):0).attr("opacity",e=>e.value/this.totalValue>=t?1:0).style("pointer-events","none").style("overflow","visible").append("xhtml:div").style("width","100%").style("height","100%").style("display","flex").style("align-items","center").style("justify-content","center").html(t=>{const n=m.multiline(t.data.key),a=m.createLabelContext(this,t,2);return e(t,n,a)}):this.bigLabelsGroup.selectAll("text").data(n).enter().append("text").attr("class","field").attr("data-bigCluster",t=>t.data.key).attr("text-anchor","start").attr("data-value",t=>t.value).attr("data-ratio",t=>t.value/this.totalValue).style("font-size",t=>m.fontScale(this.hierarchy,t)+"em").attr("paint-order","stroke").style("fill",t=>m.colorVar2(t.parent.color,0,.2,-.2)).attr("transform",t=>t.polygon?.site?`translate(${[t.polygon.site.x,t.polygon.site.y+m.getLabelHeightOffset(this,t)]})`:"translate(0,0)").html(t=>m.multiline(t.data.key)).attr("opacity",e=>e.value/this.totalValue>=t?1:0)}_drawPercentLabels(){const{showPercent:t}=this.params,e=this.allNodes.filter(t=>1===t.depth).length>1?1:2;this.percentLabelsGroup.selectAll("text").data(this.allNodes.filter(t=>t.depth===e)).enter().append("text").attr("class",t=>`budget percent label-${t.id}`).attr("text-anchor","middle").style("font-size",t=>.8*m.fontScale(this.hierarchy,t)+"em").attr("transform",t=>t.polygon?.site?`translate(${[t.polygon.site.x,t.polygon.site.y+8*m.fontScale(this.hierarchy,t)*(m.multiline(t.data.key,!0)[1]+2.2)]})`:"translate(0,0)").text(t=>" "+p.format(".0%")(t.value/this.totalValue)).attr("opacity",e=>t&&Math.round(e.value/this.totalValue*100)>0?1:0)}_drawSectorLabels(){const{underLabel:t,ratioLimit:e}=this.params;this.labelsGroup.selectAll("text").data(this.allNodes.filter(t=>3===t.depth)).enter().append("text").attr("class",t=>`sector label-${t.id}`).attr("data-cluster",t=>t.data.key).attr("data-value",t=>t.value).attr("data-ratio",t=>t.value/this.totalValue).attr("text-anchor","start").style("font-size",t=>m.fontScale2(this.hierarchy,t)+"em").style("fill",t=>m.getHSLColor(t.color,0,-.1,-.3)).attr("transform",e=>e.polygon?.site?t?`translate(${[e.polygon.site.x,e.polygon.site.y+8*m.fontScale1(this.hierarchy,e.data.data.bigClusterLabel,e.parent.value)*(m.multiline(e.data.data.bigClusterLabel,!0)[1]+.5)]})`:`translate(${m.getLabelPos(this,e)})`:"translate(0,0)").html(t=>m.multiline(t.data.key)).attr("opacity",t=>t.value/this.totalValue>e?1:0)}_drawPopLabels(){const{sizeLimit:t}=this.params;this.popLabelsGroup.selectAll("text").data(this.allNodes.filter(t=>3===t.depth)).enter().append("text").attr("class",t=>`budget label-${t.id}`).attr("text-anchor","middle").style("font-size",t=>.8*m.fontScale2(this.hierarchy,t)+"em").attr("data-pop",t=>t.data.data.clusterLabel??t.data.data.bigClusterLabel).attr("transform",t=>t.polygon?.site?`translate(${[t.polygon.site.x,t.polygon.site.y+m.varFontScale(this,t)]})`:"translate(0,0)").text(t=>m.bigFormat(t.data.values[0].size)).attr("opacity",e=>e.value>t?1:0)}_applyPostEffects(){const{showRegion:t,pebbleRound:e,pebbleWidth:n}=this.params;t&&this.labelAdjuster.adjust(this.svg.node(),{verticalSpacing:0}),this.pebbleRenderer.render(this.svg.node(),e,n,m.colorVar.bind(m))}}t.LabelAdjuster=u,t.PebbleRenderer=f,t.VoronoiTreemap=x,t.VoronoiTreemapHelpers=m,t.createDOMPopup=y,t.default=x,t.getBubbleStyles=b,t.getPopupStyles=function(){return'\n.voronoi-popup-content {\n  position: absolute;\n  background: #fffe;\n  border: 2px solid #555;\n  border-radius: 30px;\n  padding: 10px;\n  z-index: 1000000;\n  transform: translateX(-50%) translateY(-100%);\n  min-width: 100px;\n}\n\n.voronoi-popup-content::before {\n  content: " ";\n  position: absolute;\n  top: 100%;\n  left: 50%;\n  margin-left: -10px;\n  border-width: 10px;\n  border-style: solid;\n  border-color: #555 transparent transparent transparent;\n}\n\n.voronoi-popup-content::after {\n  content: " ";\n  position: absolute;\n  top: 100%;\n  left: 50%;\n  margin-left: -8px;\n  border-width: 8px;\n  border-style: solid;\n  border-color: #fff transparent transparent transparent;\n}\n\n.voronoi-popup-message {\n  max-width: 350px;\n  min-width: 200px;\n  padding: 1em;\n  line-height: 1.5;\n  color: #444;\n  text-align: left;\n  max-height: 400px;\n  overflow-y: scroll;\n  overflow-x: clip;\n}\n'},t.nestingForVoronoi=g,t.showVoronoiPopup=function(t,e={}){const{format:n="{text}",popupId:a="voronoi-popup",className:o="voronoi-popup-container",onClose:r=null}=e,i=document.getElementById(a);if(i&&i.remove(),!t||!t.clickArea)return void(r&&r());const l=t.clickArea.node(),s=l.ownerSVGElement;if(!s)return;const c=l.getBBox(),d=c.x+c.width/2,h=c.y+c.height/2,p=s.createSVGPoint();p.x=d,p.y=h;const f=p.matrixTransform(s.getScreenCTM()),u=f.x+window.scrollX,g=f.y+window.scrollY,m=f.y,y=window.innerHeight-f.y,b=m<150||y>m,x={key:t.key,...t.data||{},...t.data?.data||{},...t.d?.data?.data||{}};let v=n.replace(/\{(\w+)\}/g,(t,e)=>{const n=x[e];return null!=n?String(n):t}).replace(/\\n/g,"<br>").replace(/\n/g,"<br>");const w=document.createElement("div");w.id=a,w.className=o,Object.assign(w.style,{position:"absolute",left:"-9999px",top:"0px",zIndex:"1000"}),w.classList.add(b?"popup-below":"popup-above"),w.innerHTML=`<div class="voronoi-popup-content">\n    <div class="voronoi-popup-message">${v}</div>\n  </div>`,document.body.appendChild(w);const L=w.offsetWidth,k=w.offsetHeight;let C=u-L/2;C<10?C=10:C+L>window.innerWidth-10&&(C=window.innerWidth-L-10);const _=b?g+5:g-5-k;w.style.left=`${C}px`,w.style.top=`${_}px`;const M=t=>{if(!w.contains(t.target)&&!s.contains(t.target)){w.remove(),document.removeEventListener("click",M),document.removeEventListener("touchstart",M);const t=s.querySelector("path.clicked");t&&t.classList.remove("clicked"),r&&r()}};return setTimeout(()=>{document.addEventListener("click",M),document.addEventListener("touchstart",M)},10),w},t.showVoronoiPopupLegacy=function(t){if(!t)return null;const e=t.data||{};return"undefined"!=typeof html?html`<div style="
      background: #fffe;
      border: 2px solid #555;
      border-radius: 15px;
      padding: 15px;
      max-width: 350px;
      min-width: 200px;
    ">
      <div style="font-size: 1.2em; font-weight: bold; margin-bottom: 0.5em;">
        ${e.bigClusterLabel||"N/A"}
      </div>
      <div style="margin-bottom: 0.3em;">
        <strong>Region:</strong> ${e.region||"N/A"}
      </div>
      <div>
        <strong>Size:</strong> ${e.bubbleSize||"N/A"}
      </div>
    </div>`:y(t)},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=voronoi-treemap.min.js.map
